<p>这两天偶然间看到强大的Python可以发送邮件，刚好C++这门课每次的课程作业都需要发给老师，于是就想折腾折腾Python的邮件模块，写个小脚本自动发邮件～～～</p>

<!--more-->
<h2 id="基本思路">基本思路</h2>
<ul>
  <li>构造MIMEMultipart对象做为根容器</li>
  <li>构造MIMEText对象做为邮件显示内容并附加到根容器</li>
  <li>构造MIMEBase对象做为文件附件内容并附加到根容器
　　a. 读入文件内容并
　　b. 设置附件头</li>
  <li>设置根容器属性</li>
  <li>得到格式化后的完整文本</li>
  <li>用smtp发送邮件</li>
</ul>

<h2 id="先尝试下发送简单的文本吧">先尝试下发送简单的文本吧</h2>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
<span class="c">#-*- coding: utf-8 -*-</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s">'ZYSzys'</span>

<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">from</span> <span class="nn">email.mime.text</span> <span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">from</span> <span class="nn">email.mime.multipart</span> <span class="kn">import</span> <span class="n">MIMEMultipart</span>

<span class="k">def</span> <span class="nf">SendMail</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">smtp</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
	<span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">()</span>
	<span class="n">msg</span><span class="p">[</span><span class="s">'Subject'</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
	<span class="n">msg</span><span class="p">[</span><span class="s">'From'</span><span class="p">]</span> <span class="o">=</span> <span class="n">sender</span>
	<span class="n">msg</span><span class="p">[</span><span class="s">'To'</span><span class="p">]</span> <span class="o">=</span> <span class="n">to</span>
	<span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">MIMEText</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="s">'html'</span><span class="p">,</span> <span class="s">'utf-8'</span><span class="p">))</span>

	<span class="k">try</span><span class="p">:</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">()</span>
		<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">smtp</span><span class="p">)</span> <span class="c"># 连接smtp服务器</span>
		<span class="n">s</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="c">#登录邮箱</span>
		<span class="n">s</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span> <span class="c">#发送邮件</span>
		<span class="n">s</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
		<span class="k">print</span> <span class="s">'Send email successfully!'</span>
	<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="k">print</span> <span class="n">e</span><span class="p">,</span> <span class="s">'Send email failed...'</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
	<span class="n">subject</span> <span class="o">=</span> <span class="s">'life is short, learning python'</span> <span class="c"># 邮件主题</span>
	<span class="n">text</span> <span class="o">=</span> <span class="s">"Happy Everyday!"</span> <span class="c"># 邮件正文</span>
	<span class="n">to</span> <span class="o">=</span> <span class="s">'..............com'</span> <span class="c"># 收件人邮箱</span>
	<span class="n">sender</span> <span class="o">=</span> <span class="s">'...........@163.com'</span> <span class="c"># 发件人邮箱</span>
	<span class="n">smtp</span> <span class="o">=</span> <span class="s">'smtp.163.com'</span> <span class="c"># smtp服务地址</span>
	<span class="n">password</span> <span class="o">=</span> <span class="s">'..........'</span> <span class="c"># 发件邮箱密码</span>
	<span class="n">SendMail</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">smtp</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="源码请见sendemail">源码请见<a href="https://github.com/ZYSzys/SendEmail">SendEmail</a></h2>
