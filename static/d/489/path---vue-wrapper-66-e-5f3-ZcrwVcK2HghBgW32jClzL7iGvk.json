{"data":{"site":{"siteMetadata":{"title":"ZYSzys's Blog","author":"ZYSzys"}},"markdownRemark":{"id":"b7203c98-9003-5655-ac56-5710d5e28b15","excerpt":"为了能在Vue上更简便地使用 canvas-nest.js 这个炫酷的特效，在原项目作者的提醒下，花了几小时直接将canvas-nest封装成了 vue-canvas-nest 组件。 初始化 安装原项目依赖 编写组件 仔细阅读一下原项目的README，发现它只有一个API…","html":"<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eba26e80cff2802ea870a92bacf30bf4/28dbb/vue-canvas-nest.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABKklEQVQ4y41TS07DMBDNLVlxk0o9A1dgh3oFxBkQa9ZIIFVN7Mbxb/zwOEljuzFiopE98czzm4+7EAJYeM2VCHCeoIyGN0Avp12/XFm66FL9XPY0Ozy9nvB4OOLl4y3ZPt5Ug6zCdpcb60oRjANZ3r8/8fB8xI/qk81nrawSwxb1NZC/L33eAAhNwMQwN7zfAMdRoR8EhLjiKkYMQuLSS6jJgF3qlAtArlt5Y6xVbIj1DjICX6TAqCdY51Mp5mr8symszgLaEEwE5C6fxQBlTbQ96MYqbGWpU+YDonBzci4CaoKOyMySwbS3SdsNWQCdnWtXMq0CdtMLdx0vujwDAnlNsWW3nCHz2WdZzWH7FayDXg9yDV4wrJ1aQXmKd2NTU89T/+tF7F3O8gsCNQHC0cA8bAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"vue-canvas-nest效果\"\n        title=\"\"\n        src=\"/static/eba26e80cff2802ea870a92bacf30bf4/623ee/vue-canvas-nest.png\"\n        srcset=\"/static/eba26e80cff2802ea870a92bacf30bf4/816c5/vue-canvas-nest.png 148w,\n/static/eba26e80cff2802ea870a92bacf30bf4/c766b/vue-canvas-nest.png 295w,\n/static/eba26e80cff2802ea870a92bacf30bf4/623ee/vue-canvas-nest.png 590w,\n/static/eba26e80cff2802ea870a92bacf30bf4/e5345/vue-canvas-nest.png 885w,\n/static/eba26e80cff2802ea870a92bacf30bf4/7a439/vue-canvas-nest.png 1180w,\n/static/eba26e80cff2802ea870a92bacf30bf4/28dbb/vue-canvas-nest.png 1440w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>为了能在Vue上更简便地使用<a href=\"https://github.com/hustcc/canvas-nest.js\">canvas-nest.js</a>这个炫酷的特效，在原项目作者的提醒下，花了几小时直接将canvas-nest封装成了<a href=\"https://github.com/ZYSzys/vue-canvas-nest\">vue-canvas-nest</a>组件。</p>\n<!--more-->\n<h2>初始化</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># init</span>\nvue init webpack-simple vue-canvas-nest\n<span class=\"token comment\"># install dependencies</span>\n<span class=\"token function\">cd</span> vue-canvas-nest <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">npm</span> <span class=\"token function\">install</span></code></pre></div>\n<h2>安装原项目依赖</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> canvas-nest.js</code></pre></div>\n<h2>编写组件</h2>\n<p>仔细阅读一下原项目的README，发现它只有一个API，并且作者已经说明了如何使用，只需传入需要渲染的元素和canvas-nest配置:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// There is only one API, use it like:</span>\n\n<span class=\"token keyword\">import</span> CanvasNest <span class=\"token keyword\">from</span> <span class=\"token string\">'canvas-nest.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  color<span class=\"token punctuation\">:</span> <span class=\"token string\">'255,0,0'</span><span class=\"token punctuation\">,</span>\n  count<span class=\"token punctuation\">:</span> <span class=\"token number\">88</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// render nest on element with config.</span>\n<span class=\"token keyword\">const</span> cn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CanvasNest</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// destroy</span>\ncn<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>将原来的<code class=\"language-text\">src</code>文件夹重命名为<code class=\"language-text\">example</code>以便后期当示例和调试使用。</p>\n<p>新建<code class=\"language-text\">src</code>文件夹，并在<code class=\"language-text\">src</code>文件夹下建立文件<code class=\"language-text\">vueCanvasNest.vue</code>，代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>vue-canvas-nest-element<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span><span class=\"token property\">top</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><span class=\"token property\">left</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><span class=\"token property\">right</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><span class=\"token property\">z-index</span><span class=\"token punctuation\">:</span> -1<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script language-javascript\">\n<span class=\"token keyword\">import</span> CanvasNest <span class=\"token keyword\">from</span> <span class=\"token string\">'canvas-nest.js'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'vueCanvasNest'</span><span class=\"token punctuation\">,</span>\n  props<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      type<span class=\"token punctuation\">:</span> Object<span class=\"token punctuation\">,</span>\n      <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n          color<span class=\"token punctuation\">:</span> <span class=\"token string\">'255,0,0'</span><span class=\"token punctuation\">,</span>\n          count<span class=\"token punctuation\">:</span> <span class=\"token number\">88</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      cn<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">mounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.vue-canvas-nest-element'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CanvasNest</span><span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">beforeDestroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cn<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>同时新建一个叫<code class=\"language-text\">index.js</code>导出组件</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> vueCanvasNest <span class=\"token keyword\">from</span> <span class=\"token string\">'./vueCanvasNest.vue'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> vueCanvasNest</code></pre></div>\n<h2>示例测试</h2>\n<p>在<code class=\"language-text\">example</code>文件夹下的<code class=\"language-text\">App.vue</code>文件里加入组件<br>\njavascript标签中代码：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> vueCanvasNest <span class=\"token keyword\">from</span> <span class=\"token string\">'../'</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'app'</span><span class=\"token punctuation\">,</span>\n  components<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> vueCanvasNest <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      msg<span class=\"token punctuation\">:</span> <span class=\"token string\">'Welcome to Your Vue.js App'</span><span class=\"token punctuation\">,</span>\n      config<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        color<span class=\"token punctuation\">:</span> <span class=\"token string\">'0,0,255'</span><span class=\"token punctuation\">,</span>\n        count<span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>template标签中加入一行：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>vue-canvas-nest</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>vue-canvas-nest</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2>更改webpack.config.js</h2>\n<p>entry改为 ./src/index.js </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    entry<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/index.js'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>开发环境下entry改为 ./example/main.js</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'production'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  module<span class=\"token punctuation\">.</span>exports<span class=\"token punctuation\">.</span>entry <span class=\"token operator\">=</span> <span class=\"token string\">'./example/main.js'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>运行</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> run dev</code></pre></div>\n<p>此时就能看到炫酷的canvas-nest效果了</p>\n<h2>发布组件到npmjs</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># npm初始化</span>\n<span class=\"token function\">npm</span> init \n\n<span class=\"token comment\"># 按照提示完成package.json后</span>\n<span class=\"token function\">npm</span> publish</code></pre></div>\n<h2>项目完整地址：<a href=\"https://github.com/ZYSzys/vue-canvas-nest\">vue-canvas-nest</a></h2>","frontmatter":{"title":"Vue封装canvas-nest组件","date":"June 24, 2018","description":"为了能在Vue上更简便地使用 canvas-nest.js 这个炫酷的特效，花了几小时直接将canvas-nest封装成了 vue-canvas-nest 组件。"}}},"pageContext":{"slug":"/vue-wrapper/","previous":{"fields":{"slug":"/setTimeout/"},"frontmatter":{"title":"一道经典面试题-----setTimeout(function(){}，0)"}},"next":{"fields":{"slug":"/sort-github-stars-size/"},"frontmatter":{"title":"GitHub 仓库按大小排序"}}}}